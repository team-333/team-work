<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 	
		"-//mybatis.org//DTD Mapper 3.0//EN" 
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="com.itbank.dao.BoardDAO">
	<select id="selectOne" resultType="BoardVO" parameterType="PageVO">
		<![CDATA[
			select * from 
				(select rownum as rn, a.* from 
					(select * from board where teamid = ${teamid} order by time desc)
			 	a where rownum <= ${EndNum}) 
			where ${StartNum} <= rn
		]]>
	</select>
	
	<select id="selectImg" resultType="String" parameterType="Integer">
		select pictureurl from members where memberid = #{memberId}
	</select>
	
	<select id="selectCheck" resultType="Integer" parameterType="Integer">
		select memberid from memberteam where teamid = #{teamid}
	</select>
	
	<select id="selectBoardCheck" resultType="Integer" parameterType="PageVO">
		select memberid from board where num = #{page} and teamid = ${teamid}
	</select>
	
	<insert id="insert" parameterType="BoardVo">
		insert into board (teamid, memberid, num, writer, context)
						 values(${teamid}, ${memberid},
						 	(select NVL(max(num),0)+1 from board where teamid = ${teamid}), 
						 		#{writer}, #{context})
	</insert>	
	
	<delete id="delete" parameterType="PageVO">
		delete board where num = ${page} and teamid = ${teamid}
	</delete>
	
	<update id="update" parameterType="BoardVo">
		update board set context = #{context}, time = sysdate where num = ${num} and teamid = ${teamid}
	</update>
</mapper>